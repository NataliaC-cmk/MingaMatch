<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title id="profileTitle">Perfil del Profesor | Minga Match</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Placeholder limpio que ocupa el mismo espacio */
        .img-placeholder { 
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f1f5f9; /* slate-100 */
            color: #64748b; /* slate-500 */
            border: 1px solid #cbd5e1;
            font-size: 12px;
            text-align: center;
        }
        /* Estilo para ocultar la imagen rota */
        .hidden-on-error { display: none !important; }
    </style>
</head>
<body class="bg-gray-50">

<header class="bg-slate-800 text-white shadow-md sticky top-0 z-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center">
                <img src="logo-minga.png" alt="Minga Match Logo" class="h-8 w-auto mr-3" id="logo-img"/>
                <span class="font-bold text-xl">Minga Match</span>
            </div>
            <div class="flex items-center gap-4">
                <a href="#" onclick="redirectTo('/admin-dashboard.html');" class="bg-white text-slate-800 font-bold py-2 px-4 rounded-lg hover:bg-slate-200 transition duration-300">
                    Volver al Dashboard
                </a>
            </div>
        </div>
    </div>
</header>

<main class="max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
    <h1 class="text-3xl font-bold text-slate-900 mb-2">Detalles del Perfil</h1>
    <p class="text-slate-600 mb-8">Información completa ingresada por el profesor (Solo lectura).</p>

    <div id="profileContainer" class="bg-white shadow-xl rounded-2xl p-8 space-y-8">
        <div id="loading" class="text-center py-10 text-slate-500">Cargando perfil...</div>
        
        </div>
</main>

<script>
    // CRÍTICO: Define la ruta base del repositorio
    const REPO_PATH = '/MingaMatch'; 

    // Función auxiliar para redirigir, asegurando la estabilidad de la ruta
    window.redirectTo = function(path) {
        window.location.href = REPO_PATH + path;
    };

    // --- Data Mockup (Simulando la respuesta detallada del API para un profesor) ---
    const mockProfileData = {
        fullName: "María Clara Feliciano",
        email: "maria.clara@minga.com",
        phone: "+501-667-1234",
        currentCountry: "Belice",
        englishLevel: "B2 Intermediate",
        usaSSN: "NO",
        yearsExp: 23,
        
        uniName: "UNIVERSITY COLLEGE OF BELIZE",
        degreeType: "BACHELOR OF SCIENCE",
        fieldOfStudy: "PRIMARY EDUCATION",
        
        currentPosition: "TEACHER 7, 8",
        currentTasks: "Teaching LANGUAGE ARTS, SOCIAL STUDIES, RELIGION, HEALTH SCIENCE.",
        totalMonthsCurrentJob: 108,
        prevPosition: "English & Literature Teacher High School Students (2009-2015)",
        credentialStatus: "NO", 
        
        // ** Rutas de Archivos Simulado **
        photoUrl: '/uploads/profile_maria.jpg', // Ruta simulada
        videoUrl: 'https://www.youtube.com/embed/simulated-video-id',
    };

    // --- Funciones de Renderizado ---

    function renderProfile(profile) {
        const loadingEl = document.getElementById('loading');
        if (loadingEl) loadingEl.remove();

        document.getElementById('profileTitle').textContent = `Perfil de ${profile.fullName} | Minga Match`;
        
        const container = document.getElementById('profileContainer');
        container.innerHTML = `
            <div class="flex justify-between items-start border-b pb-4">
                <div>
                    <h2 class="text-3xl font-extrabold text-blue-600">${profile.fullName}</h2>
                    <p class="text-slate-600 mt-1">${profile.currentCountry} | ${profile.englishLevel}</p>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium">Contacto:</p>
                    <a href="mailto:${profile.email}" class="text-slate-700 hover:text-slate-900 block">${profile.email}</a>
                    <a href="https://wa.me/${profile.phone.replace(/[^0-9]/g, '')}" target="_blank" class="text-green-600 hover:text-green-800 block">${profile.phone} (WhatsApp)</a>
                </div>
            </div>

            <section>
                <h3 class="text-xl font-bold text-slate-800 border-b pb-2 mb-4">1. Datos Personales</h3>
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div><strong>Años de Experiencia:</strong> ${profile.yearsExp}</div>
                    <div><strong>País de Residencia:</strong> ${profile.currentCountry}</div>
                    <div><strong>Nivel de Inglés:</strong> ${profile.englishLevel}</div>
                    <div><strong>SSN Americano:</strong> ${profile.usaSSN}</div>
                </div>
            </section>

            <section>
                <h3 class="text-xl font-bold text-slate-800 border-b pb-2 mb-4">2. Educación y Credenciales</h3>
                <div class="space-y-3">
                    <p><strong>Universidad:</strong> ${profile.uniName}</p>
                    <p><strong>Título Principal:</strong> ${profile.degreeType} en ${profile.fieldOfStudy}</p>
                    <p><strong>Credential Evaluation (FCE):</strong> 
                        <span class="font-bold ${profile.credentialStatus === 'SI' ? 'text-green-600' : 'text-red-600'}">${profile.credentialStatus}</span>
                    </p>
                </div>
            </section>

            <section>
                <h3 class="text-xl font-bold text-slate-800 border-b pb-2 mb-4">3. Experiencia y Puesto Actual</h3>
                <div class="space-y-3">
                    <p><strong>Puesto Actual:</strong> ${profile.currentPosition}</p>
                    <p><strong>Meses en Puesto Actual:</strong> ${profile.totalMonthsCurrentJob} meses</p>
                    <p><strong>Tareas:</strong> ${profile.currentTasks}</p>
                    <p><strong>Puesto Previo Relevante:</strong> ${profile.prevPosition}</p>
                </div>
            </section>
            
            <section>
                <h3 class="text-xl font-bold text-slate-800 border-b pb-2 mb-4">4. Material de Presentación</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <div>
                        <p class="font-bold mb-2">Foto de Perfil</p>
                        <div class="w-32 h-32 relative">
                            <img id="profile-photo" src="${REPO_PATH + profile.photoUrl}" 
                                 onerror="this.outerHTML='<div class=\\"w-32 h-32 rounded-lg shadow-md img-placeholder\\">FOTO NO DISPONIBLE</div>'" 
                                 alt="Foto de perfil del profesor" class="w-full h-full object-cover rounded-lg shadow-md border">
                        </div>
                    </div>

                    <div>
                        <p class="font-bold mb-2">Video de Presentación</p>
                        <div class="relative pt-[56.25%]"> <iframe 
                                class="absolute top-0 left-0 w-full h-full rounded-lg shadow-lg" 
                                src="${profile.videoUrl}" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                </div>
            </section>
        `;
    }

    // --- Inicialización y Lógica ---

    document.addEventListener('DOMContentLoaded', () => {
        // CRÍTICO: Corrección de la ruta del logo
        const logo = document.getElementById('logo-img');
        if (logo) {
            logo.src = REPO_PATH + '/logo-minga.png';
        }
        
        const urlParams = new URLSearchParams(window.location.search);
        const teacherId = urlParams.get('id');

        if (!teacherId) {
            document.getElementById('profileContainer').innerHTML = `<p class="text-red-600">Error: No se proporcionó ID de profesor.</p>`;
            return;
        }

        // 2. Determinar la ruta de regreso (Admin o Escuela)
        const role = localStorage.getItem('role');
        const dashboardLink = (role === 'admin') ? '/admin-dashboard.html' : '/dashboard-school.html';
        document.querySelector('header a').setAttribute('onclick', `redirectTo('${dashboardLink}');`);

        // Simular la carga de datos
        renderProfile(mockProfileData); 
    });
</script>
</body>
</html>