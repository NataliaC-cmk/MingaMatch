<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Minga Match | Editar Perfil</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/i18next/dist/umd/i18next.min.js" defer></script>
    <script src="i18n.js" defer></script> 
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50">

<div class="min-h-screen flex flex-col">
    <header class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            
            <a href="#" onclick="redirectTo('/dashboard-teacher.html');" class="flex items-center space-x-2">
                <img src="logo-minga.png" alt="Minga Match Logo" class="h-8 w-auto" id="logo-img"/>
                <span class="text-xl font-bold text-blue-700">Minga Match</span>
            </a>

            <div class="flex items-center space-x-4">
                <button onclick="redirectTo('/dashboard-teacher.html');" class="text-sm font-medium text-slate-600 hover:text-blue-600 transition flex items-center">
                    &larr; <span class="ml-1" data-i18n="backToDashboard">Volver al Dashboard</span>
                </button>
                <button id="logout-button" class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-600 transition duration-150">
                    <span data-i18n="logoutButton">Cerrar Sesión</span>
                </button>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-3xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-10">
        
        <div class="mb-8">
            <h1 class="text-3xl font-extrabold text-slate-900">Editar Mi Perfil Profesional</h1>
            <p class="mt-2 text-lg text-slate-500">Actualiza tu información personal y profesional.</p>
        </div>

        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-slate-200">
            <form id="profile-form" class="space-y-6">
                
                <div class="border-b border-gray-200 pb-4">
                    <h2 class="text-xl font-semibold text-slate-700 mb-4">Datos Personales</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        <div>
                            <label for="full_name" class="block text-sm font-medium text-slate-700">Nombre Completo</label>
                            <input type="text" id="full_name" required value="María Clara" class="mt-1 block w-full px-4 py-2 rounded-lg border border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        
                        <div>
                            <label for="email" class="block text-sm font-medium text-slate-700">Email</label>
                            <input type="email" id="email" required value="test@teacher.com" disabled class="mt-1 block w-full px-4 py-2 rounded-lg border border-slate-300 bg-gray-100 shadow-sm">
                        </div>
                        
                        <div>
                            <label for="country" class="block text-sm font-medium text-slate-700">País de Residencia</label>
                            <select id="country" class="mt-1 block w-full px-4 py-2 rounded-lg border border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                <option value="colombia">Colombia</option>
                                <option value="mexico">México</option>
                                </select>
                        </div>
                        
                        <div>
                            <label for="phone" class="block text-sm font-medium text-slate-700">Teléfono</label>
                            <input type="tel" id="phone" value="+57 300 1234567" class="mt-1 block w-full px-4 py-2 rounded-lg border border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <div class="border-b border-gray-200 pb-4">
                    <h2 class="text-xl font-semibold text-slate-700 mb-4">Datos Profesionales</h2>
                    <div class="space-y-4">
                        <div>
                            <label for="subject" class="block text-sm font-medium text-slate-700">Materia de Especialización</label>
                            <input type="text" id="subject" value="Matemáticas Avanzadas" required class="mt-1 block w-full px-4 py-2 rounded-lg border border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="years_experience" class="block text-sm font-medium text-slate-700">Años de Experiencia</label>
                            <input type="number" id="years_experience" value="12" required class="mt-1 block w-full px-4 py-2 rounded-lg border border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="certification" class="block text-sm font-medium text-slate-700">Tipo de Certificación</label>
                            <input type="text" id="certification" value="Licenciatura en Educación" class="mt-1 block w-full px-4 py-2 rounded-lg border border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <p id="save-status" class="text-sm text-center text-red-600 h-5"></p>
                <button type="submit" id="save-button" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300 text-lg">
                    Guardar Cambios
                </button>
            </form>
        </div>
    </main>
</div>

<script>
    // CRÍTICO: Define la ruta base del repositorio
    const REPO_PATH = '/MingaMatch'; 
    
    // Función auxiliar para redirigir, asegurando la estabilidad de la ruta
    window.redirectTo = function(path) {
        window.location.href = REPO_PATH + path;
    };

    // --- Guardia de Sesión ---
    (function guard() {
        const token = localStorage.getItem('token');
        const role = localStorage.getItem('role');
        
        if (!token || role !== 'teacher') {
            console.log('Sesión no válida o rol incorrecto. Redirigiendo a login.');
            window.location.href = REPO_PATH + '/login.html';
        }
    })();

    document.addEventListener('DOMContentLoaded', () => {
        // CRÍTICO: Corrección de la ruta del logo
        const logo = document.getElementById('logo-img');
        if (logo) {
            logo.src = REPO_PATH + '/logo-minga.png';
        }
        
        // Simulación: Cargar datos del perfil (en un entorno real, esto sería una llamada API)
        // loadProfileData(); 

        const form = document.getElementById('profile-form');
        const saveButton = document.getElementById('save-button');
        const saveStatus = document.getElementById('save-status');

        // Lógica de Guardado del Formulario (Simulada)
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            saveStatus.textContent = '';
            saveButton.disabled = true;
            saveButton.textContent = 'Guardando...';

            setTimeout(() => {
                // SIMULACIÓN DE ÉXITO
                saveStatus.classList.remove('text-red-600');
                saveStatus.classList.add('text-green-600');
                saveStatus.textContent = '¡Cambios guardados con éxito!';
                saveButton.textContent = 'Guardar Cambios';
                saveButton.disabled = false;

                // En un entorno real, redirigirías al dashboard:
                // window.location.href = REPO_PATH + '/dashboard-teacher.html';
            }, 1500);

        });

        // Lógica de Cerrar Sesión
        document.getElementById('logout-button').addEventListener('click', () => {
            localStorage.removeItem('token');
            localStorage.removeItem('role');
            window.location.href = REPO_PATH + '/index.html'; 
        });

         // Si i18n ya está cargado, asegura la traducción
        if (window.updateContent) {
            window.updateContent();
        }
    });
</script>
</body>
</html>